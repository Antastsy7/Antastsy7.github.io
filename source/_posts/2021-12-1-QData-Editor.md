---
title: 服务器数据实时查询修改工具
author: slakijng
avatar: \assets\img\common\avatar.jpg
categories: Tools
comments: false
date: 2021-12-01 13:01:51
tags:
- wpf
keywords:
description:
photos: /assets/img/common/qdata.jpg
---
#### 项目概述
我们项目绝大部分数据都存在表格里，一个数据要在游戏中生效需要编辑后走一遍导表流程，不仅过程繁长，是否已经生效都经常处于薛定谔状态。因此我们希望有一个可以快速查询服务器数据的工具，再这之上进一步拓展为可以快速修改服务器数据。
#### 设计思路
我们项目的reload函数可以在导表后重新加载数据并在游戏中生效，同时我们每个游戏数据data文件都会对应一个def文件，记录了这个data是由哪(些)个excel表格文件导表而来，每个字段分别被映射到哪个新的字段上。由于大部分data在服务器中是以dict形式存放的，我们只需要获取行ID，就可以索引到服务器的这条数据，对他进行修改查询操作。

实际制作遇到几个问题：

1. def文件是会一直更新的，我们需要一个在线的接口来获取最新的def文件内容（同时在线内容都是不可靠的，本地也要留一个缓存）
2. 存放在dict的数据并不是每一个字段都有。我们的表动辄就是几百个表头，每条数据都把所有字段都存下来是不可能的。因此需要解析def文件，并从中读取该表头的类型，在reload的时候将值正确解析并加进去。
3. 导表规则非常复杂。有些简单的多个字段合成一个字段的，策划看一下新字段名也大概知道怎么回事了。其他几张表拼在一起的或者规则很特殊的只能特殊处理。
4. ~~不是以dict形式存放的数据，寄~~





